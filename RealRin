local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local TS = game:GetService("TweenService")

local gui = Instance.new("ScreenGui")
gui.ResetOnSpawn = false
gui.Name = "RinHubUI"
gui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")

-- Main Container
local main = Instance.new("Frame")
main.Size = UDim2.new(0, 220, 0, 250)
main.Position = UDim2.new(0.5, -110, 0.5, -125)
main.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
main.BackgroundTransparency = 0.3
main.BorderSizePixel = 0
main.ClipsDescendants = true
main.Parent = gui

-- Minimize Icon (Draggable)
local minimizeIcon = Instance.new("ImageButton")
minimizeIcon.Size = UDim2.new(0, 50, 0, 50)
minimizeIcon.Position = UDim2.new(0, 10, 1, -60) -- Start position
minimizeIcon.Image = "rbxassetid://97994335210203" -- Gamit ang asset ID mo
minimizeIcon.BackgroundColor3 = Color3.fromRGB(0, 255, 154)
minimizeIcon.ScaleType = Enum.ScaleType.Crop
minimizeIcon.Visible = false
minimizeIcon.ImageTransparency = 0 -- Siguraduhing visible ang image
minimizeIcon.Parent = gui
Instance.new("UICorner", minimizeIcon).CornerRadius = UDim.new(1, 0)

-- Iba pang elements...
-- [Idagdag dito ang header, toggles, at buttons mula sa previous code]

-- Drag System para sa BOTH main at icon
local drag = {Enabled = false, Target = nil, Start = nil, StartPosition = nil}

local function startDragging(target)
    drag.Target = target
    drag.Enabled = true
    drag.Start = UIS:GetMouseLocation()
    drag.StartPosition = target.Position
end

local function stopDragging()
    drag.Enabled = false
    drag.Target = nil
end

-- Para sa main frame
main.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        startDragging(main)
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                stopDragging()
            end
        end)
    end
end)

-- Para sa minimize icon
minimizeIcon.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        startDragging(minimizeIcon)
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                stopDragging()
            end
        end)
    end
end)

UIS.InputChanged:Connect(function(input)
    if drag.Enabled and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = UIS:GetMouseLocation() - drag.Start
        drag.Target.Position = UDim2.new(
            drag.StartPosition.X.Scale,
            drag.StartPosition.X.Offset + delta.X,
            drag.StartPosition.Y.Scale,
            drag.StartPosition.Y.Offset + delta.Y
        )
    end
end)

-- Minimize Function (Gamit ang previous toggle system)
local function toggleGUI()
    if main.Visible then
        TS:Create(main, TweenInfo.new(0.3), {
            Size = UDim2.new(0, 0, 0, 0),
            Position = minimizeIcon.Position
        }):Play()
        minimizeIcon.Visible = true
        main.Visible = false
    else
        main.Visible = true
        TS:Create(main, TweenInfo.new(0.3), {
            Size = UDim2.new(0, 220, 0, 250),
            Position = UDim2.new(0.5, -110, 0.5, -125)
        }):Play()
        minimizeIcon.Visible = false
    end
end

-- I-connect ang mga buttons
closeBtn.MouseButton1Click:Connect(toggleGUI)
minimizeIcon.MouseButton1Click:Connect(toggleGUI)
